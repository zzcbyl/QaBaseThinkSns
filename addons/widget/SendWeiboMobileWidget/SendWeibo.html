<!--提问-->
<div class="tw_box" style="padding: 0px 5px 50px 5px;" model-node="weibo_post_box">
    <div id="sendWeiboTab" model-node="mini_editor" model-args="prompt={$prompt}">
        <div class="tw_input" style="padding-bottom: 5px;">
            <textarea id="inputor{$time}" wrap="off" name="at" class="input_tips" style="word-wrap: normal; border-radius: 4px;
                font-size: 14px; overflow: hidden; height: 30px; line-height: 30px; display: inline; box-shadow:none;
                color: #999; width: 100%;" event-node="mini_editor_textarea" model-args='t=feed' placeholder="请用一句话描述您的困惑"></textarea>
            <!--<div style="position:absolute; margin:-23px 530px 0; color:#999; width:60px; font-size:12px;"><span id="numsLeft">{$initNums}</span>/{$initNums}</div>-->
        </div>
        <h2 style="padding: 0 0 3px 0; font-size: 16px;">
            问题描述<span>(选填)</span></h2>
        <div class="tw_area">
            <textarea style="width: 100%; height: 200px; line-height: 20px; font-size: 14px; padding: 5px; border-radius: 4px;
                overflow-y: auto; background: none repeat scroll 0 0 #FFFFFF; border: 1px solid #DDDDDD;box-shadow:none;
                color: #999;" placeholder="您可以在这里继续补充问题细节"></textarea>
        </div>
        <div model-node="post_ok" style="display: none; text-align: center; position: absolute;
            top: 45%; width: 100%">
            <i class="ico-ok"></i>{:L('PUBLIC_SHARE_SUCCESS')}
        </div>
    </div>
    <!--<div class="tw_B" model-node="send_action" style="width:95%; padding:8px 6px;">
        <ul>
            <li></li>
            <li>
                <a style="background-size: 60px auto; height: 60px; left: 110px; width: 60px;" class="tiwen_btn" event-node='{$post_event}' event-args='type={$type}&app_name={$app_name}&topicHtml={$initHtml}' value=""></a>

                <input type="hidden" id="LSInviteUid" value="" />
                <input type="hidden" id="InviteUid" value="" />
                <input type="hidden" id="LSInviteUidLi" value="{$inviteUid}" />
                <input type="hidden" id="InviteUidLi" value="" />
                <input type="hidden" id="ExpertUid" value="" />
            </li>
        </ul>
        
    </div>-->
    <div style="margin-top: 5px;" model-node='send_action'>
        <div style="float: left; ">
            <input type="checkbox" name="noname" id="noname" value="111" style="vertical-align: middle;" />
            <label style="margin-left: 5px; vertical-align: middle; margin-bottom: 0px; margin-top: 5px;" for="noname">匿名</label></div>
        <!--<a href="javascript:void(0);" style="height: 30px; line-height: 30px; text-align: center; color: #424141; margin-right: 7px;
            width: 60px; font-size: 14px; font-weight: bold; float: right; background: #ccc;
            box-shadow: 2px 2px 3px #bbb;" event-node='{$post_event}' event-args='type={$type}&app_name={$app_name}&topicHtml={$initHtml}'
            value="">提问</a>-->

        <a href="javascript:void(0);" class="btn btn-primary" style="float: right; margin-top: 5px;" event-node='{$post_event}' event-args='type={$type}&app_name={$app_name}&topicHtml={$initHtml}'
           value="">提问</a>
        <input type="hidden" id="LSInviteUid" value="" />
        <input type="hidden" id="InviteUid" value="" />
        <input type="hidden" id="LSInviteUidLi" value="{$inviteUid}" />
        <input type="hidden" id="InviteUidLi" value="" />
        <input type="hidden" id="ExpertUid" value="" />
        <input type="hidden" id="Openid" value="{$openid}" />
    </div>
    <div class="clear">
    </div>
    <php>if($token == '1' || $qqtoken == '1') {</php>
    <div class="share_box">
        <div>
            分享到：</div>
        <!--<input name="" type="radio" value="" />
        <a href="#" class="s_qq"></a><a href="#" class="s_sina"></a><a href="#" class="s_tx_ed">
        </a><a href="#" class="s_rr_ed"></a><a href="#" class="s_sn_ed"></a><a href="#" class="s_bd_ed">
        </a><a href="#">更多</a>-->
        <div style="padding: 5px 0 0 20px;">
            <php>if($token == '1') {</php>
            <input type="checkbox" id="cbx_sina" name="cbxSina" style="margin-top: 3px; float: left;
                margin-right: 3px;" title="分享到新浪微博" />
            <label for="cbx_sina">
                <a class="s_sina" title="分享到新浪微博"></a>
            </label>
            <php>}</php>
            <php>if($qqtoken == '1') {</php>
            <input type="checkbox" id="cbx_qq" name="cbxQQ" style="margin-top: 3px; float: left;
                margin-right: 3px;" title="分享到腾讯微博" />
            <label for="cbx_qq">
                <a class="s_tx" title="分享到腾讯微博"></a>
            </label>
            <php>}</php>
        </div>
    </div>
    <php>}</php>
    <div id="InvitedFriend" class="pengyou" style="display: none;">
    </div>
</div>
<link href="__THEME__/css/reveal.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__THEME__/js/jquery.reveal.js"></script>
<script type="text/javascript" src="__THEME__/js/home/module.home.js"></script>
<script type="text/javascript">
    var initNums = '{$initNums}';
    var shareNums = '{$shareNums}';
    var initHtml = '{$initHtml}';
    core.loadFile(THEME_URL + '/js/plugins/core.at.js');
    $(function () {
        $('#change_weibo_tab').click(function () {
            $('div[type="weibotab"]').hide();
        });
        if ($('#inputor{$time}').get(0) != undefined) {
            setTimeout(function () {
                if (initHtml) {
                    $('#inputor{$time}').focus();
                    $('#inputor{$time}').html(initHtml);
                }
            }, 300)
        }
        //$('#message_inputor').inputToEnd(initHtml);
    });
    setTimeout(function () {
        atWho($('#inputor{$time}'));
        atWho($('#message_inputor'));
    }, 1000);

    $(document).ready(function () {
        var editor = $("#sendWeiboTab textarea");
        $(editor[0]).focus(function () {
            $(this).css("color", "#000");
            if (this.value == "请用一句话描述您的困惑") {
                this.value = "";
            }
        });
        $(editor[0]).blur(function () {
            if (this.value == "") {
                $(this).css("color", "#999");
                this.value = "请用一句话描述您的困惑";
            }
        });
        $(editor[1]).focus(function () {
            $(this).css("color", "#000");
            if (this.value == "您可以在这里继续补充问题细节") {
                this.value = "";
            }
        });
        $(editor[1]).blur(function () {
            if (this.value == "") {
                $(this).css("color", "#999");
                this.value = "您可以在这里继续补充问题细节";
            }
        });
    });

    function showUploadImg() {
        if ($('#uploadImgDiv').css('display') == 'block')
            $('#uploadImgDiv').hide();
        else
            $('#uploadImgDiv').show();
    }
    var expertLi = "";
    function changeExpert(uid) {
        var expertList = $(".zjList");
        for (var i = 0; i < expertList.length; i++) {
            $(expertList[i]).css("background", "");
        }
        $("#Expert_" + uid).css("background", "#FAE7C7");

        if (expertLi != '') {
            $('#LSInviteUidLi').val($('#LSInviteUidLi').val().replace(expertLi, ""));
        }

        $("#ExpertUid").val(uid);
        expertLi = '<li id="UserLi_' + $("#ExpertUid").val() + '"><img src="' + $("#Expert_" + $("#ExpertUid").val() + " .pro_img img").attr('src') + '"/><br/><p style="height: 20px; line-height: 20px; overflow: hidden;">' + $("#Expert_" + $("#ExpertUid").val() + " .pro_img a").attr('title') + '</p><input type="button" value="取消" onclick="cancelInvite(' + $("#ExpertUid").val() + ');"/></li>';
    }


    function Invite() {
        if ($('#LSInviteUid').val() == '' && $("#ExpertUid").val() == '') {
            ui.error('请选择邀请人');
            $("#InvitedFriend").html('');
            $("#InvitedFriend").hide();
            return;
        }
        $('#InviteUid').val($('#LSInviteUid').val() + $("#ExpertUid").val());
        //$('#InviteUid').val($('#LSInviteUid').val());
        if ($("#ExpertUid").val() != '' && $('#LSInviteUidLi').val().indexOf(expertLi) < 0) {
            $('#LSInviteUidLi').val(expertLi + $('#LSInviteUidLi').val());
        }

        $('#InviteUidLi').val($('#LSInviteUidLi').val());
        $("#InvitedFriend").html('<div style="margin:10px 0;">已邀请：</div><ul>' + $('#InviteUidLi').val() + '</ul>');
        $("#InvitedFriend").show();
        $('.reveal-modal').css({ 'visibility': 'hidden' });
        $('.reveal-modal-bg').css({ 'display': 'none' });

    }

    function cancelInvite(LiID) {
        if ($("#ExpertUid").val() == LiID) {
            $('#InviteUid').val($('#InviteUid').val().replace(',' + $("#ExpertUid").val(), ""));
            $('#LSInviteUidLi').val($('#LSInviteUidLi').val().replace(expertLi, ""));
            expertLi = "";
        }
        $('#InviteUid').val($('#InviteUid').val().replace(LiID + ',', ""));
        $('#LSInviteUid').val($('#LSInviteUid').val().replace(LiID + ',', ""));
        $("#UserLi_" + LiID).remove();
        if ($('#InviteUid').val() == "") {
            $("#InvitedFriend").html('');
            $("#InvitedFriend").hide();
        }
    }
</script>
